name = "buzzline-queue-consumer"
main = "worker.js"
compatibility_date = "2024-10-15"
compatibility_flags = ["nodejs_compat"]

# KV Namespaces (same as your main project)
[[kv_namespaces]]
binding = "BUZZLINE_MAIN"
id = "365db24eb7d647acb6e3fc39d38acd25"

[[kv_namespaces]]
binding = "BUZZLINE_ANALYTICS"
id = "45f26618ca3042ee8c90df3ac3b5ff2b"

[[kv_namespaces]]
binding = "BUZZLINE_CACHE"
id = "951b33a733c446378409d0825256c060"

# Queue consumer - Balanced async processing with KV protection
[[queues.consumers]]
queue = "contact-processing-queue"
max_batch_size = 2                # Very small: 2 messages max per worker (2 Ã— 250 = 500 ops)
max_batch_timeout = 2             # Quick processing
max_retries = 2                   # Allow retries but not excessive
max_concurrency = 10              # Good parallelism for async processing